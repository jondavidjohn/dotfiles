#!/bin/bash

# OSX Command Line Tools
xcode-select --install

# Homebrew Install
ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"

brew install \
ack \
automake \
bash \
bash-completion \
cmake \
git \
libksba \
libtool \
libyaml \
imagemagick \
icu4c \
memcached \
mysql \
nvm \
phantomjs \
rbenv \
rbenv-gem-rehash \
redis \
ruby-build \
tree \
wget \
vim

# Auto start services on login
ln -sfv /usr/local/opt/mysql/*.plist ~/Library/LaunchAgents
ln -sfv /usr/local/opt/memcached/*.plist ~/Library/LaunchAgents
ln -sfv /usr/local/opt/redis/*.plist ~/Library/LaunchAgents

GREEN="\033[32m"
YELLOW="\033[33m"
BLUE="\033[34m"
RED="\033[31m"
ENDCOLOR="\033[0m"

OS="unkown"
WORK="treehouse"

if [[ `uname` == 'Darwin' ]]; then
	OS='osx'
elif type apt-get &> /dev/null; then
	OS='debian'
elif type yum &> /dev/null; then
	OS='rhel'
fi

echo -e "${YELLOW}  Linking general files...${ENDCOLOR}"
while read location; do

	name=$(basename "$location")

	if [ -d "$HOME/$name" ]; then
		rm -rf "$HOME/$name"
	fi


	echo -e "${BLUE}    $name${ENDCOLOR}"
	ln -nsf "$location" "$HOME/$name"

done < <(find "$HOME/.dotfiles/general" -depth 1)

echo -e "${YELLOW}  Linking $OS files...${ENDCOLOR}"
while read location; do

	name=$(basename "$location")

	if [ -d "$HOME/$name" ]; then
		rm -rf "$HOME/$name"
	fi

	echo -e "${BLUE}    $name${ENDCOLOR}"
	ln -nsf "$location" "$HOME/$name"

done < <(find "$HOME/.dotfiles/os/$OS" -depth 1)

if [[ $* == *--work* ]]; then
	echo -e "${YELLOW}  Linking $WORK files...${ENDCOLOR}"
	while read location; do

		name=$(basename "$location")

		if [ -d "$HOME/$name" ]; then
			rm -rf "$HOME/$name"
		fi

		echo -e "${BLUE}    $name${ENDCOLOR}"
		ln -nsf "$location" "$HOME/$name"

	done < <(find "$HOME/.dotfiles/work/$WORK" -depth 1)
fi


source ~/.bash_profile
